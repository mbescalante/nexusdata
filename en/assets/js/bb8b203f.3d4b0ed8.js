"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6868],{409:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>t,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"data-modeling/index","title":"Estructura de Datos","description":"NexusData API proporciona un sistema robusto para modelar tus datos de manera eficiente y flexible.","source":"@site/docs/data-modeling/index.md","sourceDirName":"data-modeling","slug":"/data-modeling/","permalink":"/nexusdata/en/docs/data-modeling/","draft":false,"unlisted":false,"editUrl":"https://github.com/mbescalante/nexusdata/edit/main/docs/data-modeling/index.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"REST API","permalink":"/nexusdata/en/docs/data-sources/rest-api"},"next":{"title":"Esquemas de Datos","permalink":"/nexusdata/en/docs/data-modeling/schemas"}}');var s=r(4848),i=r(8453);const t={sidebar_position:5},o="Estructura de Datos",d={},l=[{value:"Conceptos B\xe1sicos",id:"conceptos-b\xe1sicos",level:2},{value:"Definiendo un Modelo",id:"definiendo-un-modelo",level:2},{value:"Tipos de Datos Soportados",id:"tipos-de-datos-soportados",level:3},{value:"Ejemplo con Varios Tipos",id:"ejemplo-con-varios-tipos",level:4},{value:"Relaciones entre Modelos",id:"relaciones-entre-modelos",level:2},{value:"Relaciones de Uno a Muchos",id:"relaciones-de-uno-a-muchos",level:3},{value:"Relaciones de Muchos a Muchos",id:"relaciones-de-muchos-a-muchos",level:3},{value:"Validaciones y Restricciones",id:"validaciones-y-restricciones",level:2},{value:"Validaciones de Basicas",id:"validaciones-de-basicas",level:4},{value:"Validaciones Personalizadas",id:"validaciones-personalizadas",level:4},{value:"Indices y Rendimiento",id:"indices-y-rendimiento",level:2},{value:"Hooks y Midleware",id:"hooks-y-midleware",level:2},{value:"Herencia y Composici\xf3n",id:"herencia-y-composici\xf3n",level:2},{value:"Herencia de Modelos",id:"herencia-de-modelos",level:4},{value:"Migraciones y Versionado",id:"migraciones-y-versionado",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"estructura-de-datos",children:"Estructura de Datos"})}),"\n",(0,s.jsx)(n.p,{children:"NexusData API proporciona un sistema robusto para modelar tus datos de manera eficiente y flexible."}),"\n",(0,s.jsx)(n.h2,{id:"conceptos-b\xe1sicos",children:"Conceptos B\xe1sicos"}),"\n",(0,s.jsx)(n.p,{children:"El modelado de datos en NexusData se basa en esquemas declarativos que definen:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"La estructura de tus datos"}),"\n",(0,s.jsx)(n.li,{children:"Las relaciones entre diferentes modelos"}),"\n",(0,s.jsx)(n.li,{children:"Las validaciones y restricciones"}),"\n",(0,s.jsx)(n.li,{children:"Los comportamientos personalizados"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"definiendo-un-modelo",children:"Definiendo un Modelo"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"module.exports = {\r\n  name: 'User',\r\n  fields: {\r\n    id: { type: 'id' },\r\n    username: { type: 'string', required: true },\r\n    email: { type: 'string', unique: true },\r\n    createdAt: { type: 'datetime', default: 'now()' }\r\n  }\r\n};\n"})}),"\n",(0,s.jsx)(n.h3,{id:"tipos-de-datos-soportados",children:"Tipos de Datos Soportados"}),"\n",(0,s.jsx)(n.p,{children:"NexusData soporta una amplia variedad de tipos de datos para adaptarse a tus necesidades:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"string"})," : Para texto y cadenas de caracteres"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"number"})," : Para valores num\xe9ricos (enteros y decimales)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"boolean"})," : Para valores verdadero/falso"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"date"})," : Para fechas sin informaci\xf3n de hora"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"datetime"})," : Para fechas con informaci\xf3n de hora"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"id"})," : Identificador \xfanico, generalmente UUID o autoincremental"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"json"})," : Para almacenar objetos JSON complejos"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"ejemplo-con-varios-tipos",children:"Ejemplo con Varios Tipos"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"module.exports = {\r\n  name: 'Product',\r\n  fields: {\r\n    id: { type: 'id' },\r\n    name: { type: 'string', required: true },\r\n    price: { type: 'number', min: 0 },\r\n    isAvailable: { type: 'boolean', default: true },\r\n    releaseDate: { type: 'date' },\r\n    metadata: { type: 'json' }\r\n  }\r\n};\n"})}),"\n",(0,s.jsx)(n.h2,{id:"relaciones-entre-modelos",children:"Relaciones entre Modelos"}),"\n",(0,s.jsx)(n.p,{children:"NexusData permite definir relaciones entre modelos de forma sencilla:"}),"\n",(0,s.jsx)(n.h3,{id:"relaciones-de-uno-a-muchos",children:"Relaciones de Uno a Muchos"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Modelo User\r\nmodule.exports = {\r\n  name: 'User',\r\n  fields: {\r\n    id: { type: 'id' },\r\n    username: { type: 'string', required: true },\r\n    // Relaci\xf3n uno a muchos (un usuario tiene muchos posts)\r\n    posts: { type: 'relation', model: 'Post', foreignKey: 'authorId' }\r\n  }\r\n};\r\n\r\n// Modelo Post\r\nmodule.exports = {\r\n  name: 'Post',\r\n  fields: {\r\n    id: { type: 'id' },\r\n    title: { type: 'string', required: true },\r\n    content: { type: 'string' },\r\n    // Relaci\xf3n muchos a uno (muchos posts pertenecen a un usuario)\r\n    authorId: { type: 'id', required: true },\r\n    author: { type: 'relation', model: 'User', localKey: 'authorId' }\r\n  }\r\n};\n"})}),"\n",(0,s.jsx)(n.h3,{id:"relaciones-de-muchos-a-muchos",children:"Relaciones de Muchos a Muchos"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Modelo Product\r\nmodule.exports = {\r\n  name: 'Product',\r\n  fields: {\r\n    id: { type: 'id' },\r\n    name: { type: 'string', required: true },\r\n    // Relaci\xf3n muchos a muchos (un producto tiene muchas categor\xedas)\r\n    categories: { \r\n      type: 'relation', \r\n      model: 'Category', \r\n      through: 'ProductCategory',\r\n      foreignKey: 'productId',\r\n      otherKey: 'categoryId'\r\n    }\r\n  }\r\n};\r\n\r\n// Modelo Category\r\nmodule.exports = {\r\n  name: 'Category',\r\n  fields: {\r\n    id: { type: 'id' },\r\n    name: { type: 'string', required: true },\r\n    // Relaci\xf3n muchos a muchos (una categor\xeda tiene muchos productos)\r\n    products: { \r\n      type: 'relation', \r\n      model: 'Product', \r\n      through: 'ProductCategory',\r\n      foreignKey: 'categoryId',\r\n      otherKey: 'productId'\r\n    }\r\n  }\r\n};\r\n\r\n// Modelo de uni\xf3n (tabla pivote)\r\nmodule.exports = {\r\n  name: 'ProductCategory',\r\n  fields: {\r\n    id: { type: 'id' },\r\n    productId: { type: 'id', required: true },\r\n    categoryId: { type: 'id', required: true },\r\n    // Campos adicionales si es necesario\r\n    featured: { type: 'boolean', default: false }\r\n  }\r\n};\n"})}),"\n",(0,s.jsx)(n.h2,{id:"validaciones-y-restricciones",children:"Validaciones y Restricciones"}),"\n",(0,s.jsx)(n.p,{children:"NexusData ofrece un sistema completo de validaciones para garantizar la integridad de tus datos:"}),"\n",(0,s.jsx)(n.h4,{id:"validaciones-de-basicas",children:"Validaciones de Basicas"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"module.exports = {\r\n  name: 'User',\r\n  fields: {\r\n    id: { type: 'id' },\r\n    username: { \r\n      type: 'string', \r\n      required: true,\r\n      minLength: 3,\r\n      maxLength: 50,\r\n      pattern: '^[a-zA-Z0-9_]+$' // Solo alfanum\xe9ricos y guiones bajos\r\n    },\r\n    email: { \r\n      type: 'string', \r\n      required: true,\r\n      unique: true,\r\n      format: 'email' // Validaci\xf3n de formato de email\r\n    },\r\n    age: {\r\n      type: 'number',\r\n      min: 18,\r\n      max: 120\r\n    },\r\n    website: {\r\n      type: 'string',\r\n      format: 'url', // Validaci\xf3n de URL\r\n      nullable: true // Puede ser nulo\r\n    }\r\n  }\r\n};\n"})}),"\n",(0,s.jsx)(n.h4,{id:"validaciones-personalizadas",children:"Validaciones Personalizadas"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"module.exports = {\r\n  name: 'Order',\r\n  fields: {\r\n    id: { type: 'id' },\r\n    items: { type: 'json', required: true },\r\n    totalAmount: { \r\n      type: 'number', \r\n      required: true,\r\n      validate: {\r\n        validator: function(value, data) {\r\n          // Calcular la suma de los precios de los items\r\n          const calculatedTotal = data.items.reduce(\r\n            (sum, item) => sum + (item.price * item.quantity), \r\n            0\r\n          );\r\n          // Verificar que el total coincida con la suma\r\n          return Math.abs(value - calculatedTotal) < 0.01; // Permitir peque\xf1as diferencias por redondeo\r\n        },\r\n        message: 'El monto total no coincide con la suma de los items'\r\n      }\r\n    }\r\n  }\r\n};\n"})}),"\n",(0,s.jsx)(n.h2,{id:"indices-y-rendimiento",children:"Indices y Rendimiento"}),"\n",(0,s.jsx)(n.p,{children:"Optimiza el rendimiento de tus consultas definiendo \xedndices:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"module.exports = {\r\n  name: 'Product',\r\n  fields: {\r\n    id: { type: 'id' },\r\n    name: { type: 'string', required: true },\r\n    price: { type: 'number' },\r\n    categoryId: { type: 'id' },\r\n    tags: { type: 'json' }\r\n  },\r\n  indexes: [\r\n    // \xcdndice simple\r\n    { fields: ['name'] },\r\n    // \xcdndice compuesto\r\n    { fields: ['categoryId', 'price'] },\r\n    // \xcdndice \xfanico\r\n    { fields: ['sku'], unique: true },\r\n    // \xcdndice parcial (solo para productos activos)\r\n    { \r\n      fields: ['tags'],\r\n      where: { isActive: true },\r\n      type: 'json' // \xcdndice para campo JSON\r\n    }\r\n  ]\r\n};\n"})}),"\n",(0,s.jsx)(n.h2,{id:"hooks-y-midleware",children:"Hooks y Midleware"}),"\n",(0,s.jsx)(n.p,{children:"Extiende la funcionalidad de tus modelos con hooks que se ejecutan en diferentes momentos del ciclo de vida:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"module.exports = {\r\n  name: 'User',\r\n  fields: {\r\n    id: { type: 'id' },\r\n    username: { type: 'string', required: true },\r\n    email: { type: 'string', unique: true },\r\n    password: { type: 'string', private: true }, // Campo privado, no expuesto en API\r\n    lastLogin: { type: 'datetime', nullable: true }\r\n  },\r\n  hooks: {\r\n    // Se ejecuta antes de crear un registro\r\n    beforeCreate: async (data, context) => {\r\n      // Hashear contrase\xf1a antes de guardar\r\n      if (data.password) {\r\n        data.password = await context.services.auth.hashPassword(data.password);\r\n      }\r\n      return data;\r\n    },\r\n    \r\n    // Se ejecuta despu\xe9s de crear un registro\r\n    afterCreate: async (record, context) => {\r\n      // Enviar email de bienvenida\r\n      await context.services.email.send({\r\n        to: record.email,\r\n        subject: 'Bienvenido a nuestra plataforma',\r\n        template: 'welcome'\r\n      });\r\n      return record;\r\n    },\r\n    \r\n    // Se ejecuta antes de actualizar un registro\r\n    beforeUpdate: async (data, context) => {\r\n      // Si se actualiza la contrase\xf1a, hashearla\r\n      if (data.password) {\r\n        data.password = await context.services.auth.hashPassword(data.password);\r\n      }\r\n      return data;\r\n    }\r\n  }\r\n};\n"})}),"\n",(0,s.jsx)(n.h2,{id:"herencia-y-composici\xf3n",children:"Herencia y Composici\xf3n"}),"\n",(0,s.jsx)(n.p,{children:"NexusData permite crear modelos m\xe1s complejos mediante herencia y composici\xf3n:"}),"\n",(0,s.jsx)(n.h4,{id:"herencia-de-modelos",children:"Herencia de Modelos"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Modelo base\r\nconst BaseModel = {\r\n  fields: {\r\n    id: { type: 'id' },\r\n    createdAt: { type: 'datetime', default: 'now()' },\r\n    updatedAt: { type: 'datetime', default: 'now()', onUpdate: 'now()' }\r\n  }\r\n};\r\n\r\n// Modelo que hereda del base\r\nmodule.exports = {\r\n  name: 'Product',\r\n  extends: BaseModel,\r\n  fields: {\r\n    name: { type: 'string', required: true },\r\n    price: { type: 'number', required: true }\r\n    // Hereda autom\xe1ticamente id, createdAt y updatedAt\r\n  }\r\n};\n"})}),"\n",(0,s.jsx)(n.h2,{id:"migraciones-y-versionado",children:"Migraciones y Versionado"}),"\n",(0,s.jsx)(n.p,{children:"NexusData facilita la evoluci\xf3n de tus modelos con un sistema de migraciones:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// migrations/001_initial_schema.js\r\nmodule.exports = {\r\n  up: async (db) => {\r\n    await db.createTable('users', {\r\n      id: { type: 'id' },\r\n      username: { type: 'string', required: true },\r\n      email: { type: 'string', unique: true },\r\n      createdAt: { type: 'datetime', default: 'now()' }\r\n    });\r\n    \r\n    await db.createTable('posts', {\r\n      id: { type: 'id' },\r\n      title: { type: 'string', required: true },\r\n      content: { type: 'text' },\r\n      authorId: { type: 'id', references: { table: 'users', field: 'id' } },\r\n      createdAt: { type: 'datetime', default: 'now()' }\r\n    });\r\n  },\r\n  \r\n  down: async (db) => {\r\n    await db.dropTable('posts');\r\n    await db.dropTable('users');\r\n  }\r\n};\n"})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>o});var a=r(6540);const s={},i=a.createContext(s);function t(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);